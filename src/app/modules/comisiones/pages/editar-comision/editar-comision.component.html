<div class="container shadow-sm pt-4 pl-4 pr-4 mb-5 bg-white rounded">
    <div class="row">
      <div class="col">
        <p class="text-secondary">EDITAR COMISION</p>
      </div>
    </div>
    <hr />

    <form [formGroup]="editarComision" (ngSubmit)="onUpdate()">

      <!-- DATEPICKER -->
      <ng-template #footerTemplate>
        <hr class="my-0">
        <p *ngIf="fromDate && !toDate" style="text-align: center; margin: 0; color: green;"> Elige la segunda fecha
        </p>
        <p *ngIf="!fromDate" style="text-align: center; margin: 0; color: green;"> Elige la primera fecha </p>
        <button class="btn btn-primary btn-sm m-2 float-start"
            (click)="model = today; datepicker.close()">Hoy</button>
        <button class="btn btn-secondary btn-sm m-2 float-end" (click)="datepicker.close()">Cerrar</button>
      </ng-template>
      <div class="row regular-row">
        <div class="col-4 label">Tipo de Comisión</div>
        <div class="col-sm-8">
          <input
            class="form-control"
            formControlName="tipos_comision"
          />
        </div>
      </div>
      <hr />

      <div>
        <div class="row regular-row">
          <div class="col-4 label">Lugar</div>
          <div class="col-sm-8">
            <div class="input-group">
              <input
                type="text"
                class="form-control border-right-0"
                aria-label="from"
                aria-describedby="from"
                formControlName="lugar"
              />
              <div class="input-group-append">
                <span class="input-group-text"
                  ><i class="fas fa-map-marker-alt"></i
                ></span>
              </div>
            </div>
          </div>
        </div>

        <div class="row regular-row">
          <div class="col-4 label">Idioma</div>
          <div class="col-sm-8">
            <input class="form-control" type="text" formControlName="idioma" />
          </div>
        </div>

        <div class="row regular-row">
          <div class="col-4 label">Justificación *</div>
          <div class="col-sm-8">
            <div class="form-group">
              <textarea
                class="form-control"
                rows="3"
                formControlName="justificacion"
                [ngClass]="{ 'is-invalid': submitted && f['justificacion'].errors }"
              ></textarea>
              <div
                *ngIf="submitted && f['justificacion'].errors"
                class="invalid-feedback"
              >
                <div *ngIf="f['justificacion'].errors['required']">
                  La justificacion es requerida
                </div>
              </div>
            </div>
          </div>
        </div>

    <!--- FECHAS  -->
    <hr />
    <h6>
        <span class="text-muted">Rango de fechas de la comision</span>
    </h6>

    <div class="dp-hidden position-absolute">
      <div class="input-group">
          <input name="datepicker" class="form-control" ngbDatepicker #datepicker="ngbDatepicker"
              [autoClose]="'outside'" (dateSelect)="onDateSelection($event)" [displayMonths]="2" [dayTemplate]="t"
              outsideDays="hidden" [startDate]="fromDate!" tabindex="-1" [footerTemplate]="footerTemplate"
              placement="left" [positionTarget]="buttonEl">
          <ng-template #t let-date let-focused="focused">
              <span class="custom-day" [class.focused]="focused" [class.range]="isRange(date)"
                  [class.faded]="isHovered(date) || isInside(date)" (mouseenter)="hoveredDate = date"
                  (mouseleave)="hoveredDate = null">
                  {{ date.day }}
              </span>
          </ng-template>
      </div>
    </div>

    
    <div class="row regular-row">
      <div class="col-sm-6 label">
          <div class="input-group">
              <input #dpFromDate class="form-control" type='text'
                  (click)="datepicker.toggle() ; clicked=clicked+1" placeholder="aaaa-mm-dd"
                  name="dpFromDate" formControlName="fecha_inicio"
                  (input)="fromDate = validateInput(fromDate, dpFromDate.value)"
                  [value]="formatter.format(fromDate)? formatter.format(fromDate): null "
                  [ngClass]="{'is-invalid': (!fromDate) && clicked !== 0}" >
              <button #buttonEl class="btn btn-outline-secondary"
                  (click)="datepicker.toggle() ; clicked=clicked+1"><i class="fa fa-calendar"> </i></button>
          </div>
      </div>
      <div class="col-sm-6">
          <div class="input-group" (click)="datepicker.toggle()">
              <input #dpToDate class="form-control" placeholder="aaaa-mm-dd" name="dpToDate"
                  formControlName="fecha_fin" [value]="formatter.format(toDate)"
                  (input)="toDate = validateInput(toDate, dpToDate.value)"
                  [value]="formatter.format(toDate)? formatter.format(toDate): null "
                  [ngClass]="{'is-invalid': (!toDate) && clicked !== 0}">
                  <button #buttonEl class="btn btn-outline-secondary"
                  (click)="datepicker.toggle() ; clicked=clicked+1"><i class="fa fa-calendar"> </i></button>
            </div>

      </div>
    </div>

    <!--- ANEXOS -->
    <div class="row regular-row">
      <div class="col-4 label">Anexos</div>
      <div class="col-sm-8">
        <div class="mb-3">
          <input
            class="form-control"
            type="file"
            id="formFileMultiple"
            multiple
          />
        </div>
      </div>
    </div>

    <!--- ERRORES -->
        <div *ngIf="error" class="alert alert-danger mt-3 mb-0">
          {{ error }}
        </div>
      </div>
  
      <hr />
      <div class="footer-row d-grid gap-2 d-md-flex justify-content-md-end">
        <div class="col-sm-12 col-md-4 col-lg-2 col-xl-2 p-2">
          <button
            type="button"
            class="btn btn-secondary btn-block"
            [routerLink]="['/comisiones/ver-comision', getId]"
          >
            Cancelar
          </button>
        </div>
        <div class="col-sm-12 col-md-4 col-lg-2 col-xl-2 p-2">
          <button
            class="btn btn-green btn-success btn-block"
          >
            <span *ngIf="isLoading | async" 
            class="spinner-border spinner-border-sm1"  
            role="status" aria-hidden="true"
            ></span>
            Enviar
          </button>
        </div>
      </div>
    </form>
  </div>