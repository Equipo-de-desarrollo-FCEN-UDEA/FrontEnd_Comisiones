<div class="containerInside card shadow mt-5 bg-white rounded p-5 w-75">
  <div class="row header-row">
    <div class="col">
      <span class="text-secondary">ASOCIAR UN ESTADO A LA DEDICACIÓN</span>
    </div>
  </div>

  <hr />
  <form [formGroup]="asociarEstadoForm" (ngSubmit)="asociarEstado()">
    <div class="row regular-row mt-4">

      <div class="col-md-4 col-xs-12 col-sm-6 label mb-2">Fechas inicio</div>
      <div class="col-sm-12 col-xs-12 col-md-8">
        <div class="input-group">
          <input class="form-control" placeholder="yyyy-mm-dd"
                 name="d" ngbDatepicker #d="ngbDatepicker" formControlName="fecha_inicio">
          <button class="btn btn-outline-secondary calendar" (click)="d.toggle()" type="button"><i class="fa fa-calendar"> </i></button>
        </div>
      </div>
      <div class="col-md-4 col-xs-12 col-sm-6 label mb-2">Fechas primer informe</div>
      <div class="col-sm-12 col-xs-12 col-md-8">
        <div class="input-group">
          <input class="form-control" placeholder="yyyy-mm-dd"
                 name="a" ngbDatepicker #a="ngbDatepicker" formControlName="fecha_informe">
          <button class="btn btn-outline-secondary calendar" (click)="a.toggle()" type="button"><i class="fa fa-calendar"> </i></button>
        </div>
      </div>
      <div class="col-md-4 col-xs-12 col-sm-6 label mb-2">Fechas finalización</div>
      <div class="col-sm-12 col-xs-12 col-md-8">
        <div class="input-group">
          <input class="form-control" placeholder="yyyy-mm-dd"
                 name="b" ngbDatepicker #b="ngbDatepicker" formControlName="fecha_fin">
          <button class="btn btn-outline-secondary calendar" (click)="b.toggle()" type="button"><i class="fa fa-calendar"> </i></button>
        </div>
      </div>
      
    </div>
    <hr />


    <!-- Archivos -->
    <h6 class="mt-3">
      <span class="text-muted">Resolución de la dedicación</span>
    </h6>
    <div class="alert alert-danger" *ngIf="files.length > 0 && !validTipoArchivo()">
      Ese tipo de archivo no es permitido.
    </div>
    <div class="alert-danger alert" *ngIf="files.length>0 && !validSize()">
      Los archivos no deben pesar más de 2 MB.
    </div>

    <div class="formfloatig" style="display: flex; flex-direction: column;">
      <div *ngFor="let producto of archivos; last as isLast; let i=index" class="arrayLike formfloatig">
        <div class="archivos" style="width:auto; margin-left: 10px;">
          <label class="btn-btn-default">
            <div class="fa fa-upload fa-2x "></div>
            <input [id]="i" class="file-upload" type="file" (change)='onUpload($event,i)' />
            <label [for]="i" style="margin-left: 10px;">{{files[i] ? files[i].name : 'Subir archivo' }}</label>
          </label>

        </div>
        <div class="buttons" style="width:fit-content; margin: 0;">
          <button class="btn btn-circle btn-remove m-1" type="button" (click)="removeFile(i)"><i
              class="fa fa-minus"></i>
          </button>
          <button class="btn btn-circle btn-add m-1" type="button" (click)="archivos.push(1)"
            *ngIf="isLast && archivos.length<3">
            <i class="fa fa-plus"></i>
          </button>
        </div>
      </div>
    </div>

    <div *ngIf="error" class="alert alert-danger mt-3 mb-0">
      {{ error }}
    </div>



    <hr />
    <div class="footer-row d-md-flex justify-content-md-end mb-3">
      <div class="d-grid gap-2 col-sm-12 col-md-4 col-lg-4 col-xl-4 p-2">
        <button type="button" class="btn btn-secondary float-right"
          [routerLink]="['/dedicaciones/ver-dedicacion', getId]">
          Cancelar
        </button>
      </div>
      <div class="d-grid gap-2 col-sm-12 col-md-4 col-lg-4 col-xl-4 p-2">
        <button class="btn btn-green btn-success float-right" [disabled]="(isLoading|async) || asociarEstadoForm.invalid">
          <span *ngIf="isLoading | async" class="spinner-border spinner-border-sm mr-1"></span>
          Enviar
        </button>
      </div>
    </div>
  </form>
</div>